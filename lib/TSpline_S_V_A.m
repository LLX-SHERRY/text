function PP=TSpline_S_V_A(p0,v0,a0,t0,p1,t1,p2,v2,a2,t2,step)
% nargin
R=[1,  t0,   t0*t0, t0*t0*t0,     t0*t0*t0*t0,  0,        0,       0,        0,         0;
   0,  1,    2*t0,   3*t0*t0,      4*t0*t0*t0,  0,        0,       0,        0,         0;
   0,  0,    2,         6*t0,        12*t0*t0,  0,        0,       0,        0,         0;
   1,  t1,   t1*t1, t1*t1*t1,     t1*t1*t1*t1,  0,        0,       0,        0,         0;
   0,     0,   0,    0, 0,          1,      t2,     t2*t2, t2*t2*t2, t2*t2*t2*t2;
   0,     0,   0,    0, 0,          0,       1,      2*t2,  3*t2*t2,  4*t2*t2*t2;
   0,     0,   0,    0, 0,          0,       0,         2,     6*t2,    12*t2*t2;
   0,     0,   0,    0, 0,          1,      t1,     t1*t1, t1*t1*t1, t1*t1*t1*t1;
   0,     1,    2*t1, 3*t1*t1, 4*t1*t1*t1,   0, -1,  -2*t1, -3*t1*t1, -4*t1*t1*t1;
   0,     0,       2,    6*t1,   12*t1*t1,   0,  0,     -2,    -6*t1,   -12*t1*t1      ];
p=[p0,v0,a0,p1,p2,v2,a2,p1,zeros(length(p0),1),zeros(length(p0),1)]';
p=inv(R)*p;
k=0;
for i=t0:step:t1
    k=k+1;
    S1(k,:)=p(1,:)+p(2,:)*i+p(3,:)*i*i+p(4,:)*i*i*i+p(5,:)*i*i*i*i;
%     S1(2,k)=p(2)+2*p(3)*i+3*p(4)*i*i+4*p(5)*i*i*i;
%     S1(3,k)=2*p(3)+6*p(4)*i+12*p(5)*i*i;
end
for i=(t1+step):step:t2
    k=k+1;
    S1(k,:)=p(6,:)+p(7,:)*i+p(8,:)*i*i+p(9,:)*i*i*i+p(10,:)*i*i*i*i;
%     S1(2,k)=p(7)+2*p(8)*i+3*p(9)*i*i+4*p(10)*i*i*i;
%     S1(3,k)=2*p(8)+6*p(9)*i+12*p(10)*i*i;

end
PP=S1';
